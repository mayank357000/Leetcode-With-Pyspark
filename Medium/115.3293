3293. Calculate Product Final Price ðŸ”’
Description
Table: Products

+++ 
\| product_id \| int     \| 
\| category   \| varchar \|
\| price      \| decimal \|
+++ 
\| Column Name\| Type    \| 
+++
category is the primary key for this table.
Each row contains a product category and the 
percentage discount applied to that category (values range from 0 to 100).
Write a solution to find the final price of 
each product after applying the category discount. 
If a product's category has no associated discount, 
its price remains unchanged.


Return the result table ordered by product_id in ascending order.

The result format is in the following example.

 

Example:

Input:

Products table:

++-+-+
\| product_id \| category    \| price \|
++-+-+
\| 1          \| Electronics \| 1000  \|
\| 2          \| Clothing    \| 50    \|
\| 3          \| Electronics \| 1200  \| 
\| 4          \| Home        \| 500   \|
++-+-+
  
Discounts table:

++-+
\| Electronics\| 10       \|
\| Clothing   \| 20       \|
++----+
  
Explanation:

For product 1, it belongs to the Electronics category 
which has a 10% discount, so the final price is 1000 - (10% of 1000) = 900.
For product 2, it belongs to the Clothing category which
 has a 20% discount, so the final price is 50 - (20% of 50) = 40.
For product 3, it belongs to the Electronics category and
 receives a 10% discount, so the final price is 1200 - (10% of 1200) = 1080.
For product 4, no discount is available for the Home category, 
so the final price remains 500.
Result table is ordered by product_id in ascending order.

--------------------------

SELECT 
    p.product_id,
    ROUND(p.price * (1 - COALESCE(d.discount, 0) / 100), 2) AS final_price
FROM Products p
LEFT JOIN Discounts d
    ON p.category = d.category
ORDER BY p.product_id;